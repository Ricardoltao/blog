---
title: HTTP
date: 2020-02-20 15:52:57
updated: 2020-02-26 12:46:14
tags: 
- HTTP
- http1.0 http1.1 http2.0
categories: 计算机基础
---
# HTTP

超文本传输协议（HyperText Transfer Protocol）

HTTP协议是建立在TCP协议基础之上的，当浏览器需要从服务器获取网页数据时，会发出一次HTTP请求。HTTP会通过TCP建立起一个到服务器的连接通道，当本次请求完毕后，HTTP会立即将TCP连接断开，这个过程很短。所以HTTP连接是一个短连接，是一种无状态连接。

## http传输流

![img](https://user-gold-cdn.xitu.io/2018/4/17/162d19df66466f6b?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)



## 状态码

常用状态码：

### 2XX 成功

+ 200 OK，表示从客户端发来的请求在服务器端被正确处理
+ 204 No content，表示请求成功，但响应报文不含实体的主体部分
+ 206 Partial Content，进行范围请求

### 3XX 重定向

+ 301 moved permanently，永久性重定向，表示资源已被分配了新的URL
+ 302 found，临时性重定向，表示资源临时被分配了新的URL
+ 303 see other，表示资源存在着另一个URL，应使用GET方法定向获取资源
+ 304 not modified，表示服务器允许访问资源，但因发生请求未满足条件的情况
+ 307 temporary redirect，临时重定向，和302含义相同

### 4XX 客户端错误

+ 400 bad request，请求报文存在语法错误
+ 401 unauthorized，表示发送的请求需要有通过 HTTP 认证的认证信息
+ 403 forbidden，表示对请求资源的访问被服务器拒绝
+ 404 not found，表示在服务器上没有找到请求的资源

### 5XX 服务器错误

+ 500 internal sever error，表示服务器端在执行请求时发生了错误
+ 503 service unavailable，表明服务器暂时处于超负载或正在停机维护，无法处理请求



## http1.0 http1.1 http2.0 特性及区别

### http1.0特性

+ 无状态：服务器不跟踪记录请求过的状态
+ 无连接：浏览器每次请求都需要建立tcp连接

#### 无状态

对于无状态的特性可以借助cookie/session机制来做身份认证和状态记录

#### 无连接

无连接导致性能缺陷有两种：

1. 无复用连接：
   每次发送请求都需要进行一次tcp连接（即3次握手4次挥手），使得网络的利用率非常低
2. 队头阻塞
   http1.0规定在前一个请求响应到达之后下一个请求才能发送，如果前一个阻塞，后面的请求也会阻塞

### http1.1特性

http1.1的出现是为了解决http1.0性能缺陷

http1.1特性：

+ 长连接：新增connection字段，可以设置keep-alive值保持连接不断开
+ 管道化：基于上面长连接的基础，管道化可以不等第一个请求响应继续发送后面的请求，但响应的顺序还是按照请求的顺序返回
+ 缓存处理：新增字段cache-control
+ 断点传输

#### 长连接

http1.1默认保持长连接，数据传输完成保持tcp连接不断开,继续用这个通道传输数据

#### 管道化

基于长连接的基础，我们先看没有管道化请求响应：

tcp没有断开，用的同一个通道

```
请求1 > 响应1 --> 请求2 > 响应2 --> 请求3 > 响应3
```

管道化的请求响应：

```
请求1 --> 请求2 --> 请求3 > 响应1 --> 响应2 --> 响应3
```

即使服务器先准备好响应2,也是按照请求顺序先返回响应1

虽然管道化，可以一次发送多个请求，但是响应仍是顺序返回，仍然无法解决队头阻塞的问题

#### 缓存处理

当浏览器请求资源时，先看是否有缓存的资源，如果有缓存，直接取，不会再发请求，如果没有缓存，则发送请求

通过设置字段cache-control来控制

#### 断点传输

在上传/下载资源时，如果资源过大，将其分割为多个部分，分别上传/下载，如果遇到网络故障，可以从已经上传/下载好的地方继续请求，不用从头开始，提高效率

在 Header 里两个参数实现的，客户端发请求时对应的是 Range 服务器端响应时对应的是 Content-Range

### http2.0特性

+ 二进制分帧
+ 多路复用：在共享TCP连接的基础上同时发送请求和响应
+ 头部压缩
+ 服务器推送：服务器可以额外的项客户端推送资源，而无需客户端明确的请求

#### 二进制分帧

将所有传输的信息分割为更小的消息和帧,并对它们采用二进制格式的编码

#### 多路复用

基于二进制分帧，在同一域名下所有访问都是从同一个tcp连接中走，http消息被分解为独立的帧，乱序发送，服务端根据标识符和首部将消息重新组装起来



### 区别

1. http1.0 到http1.1的主要区别，就是从无连接到长连接
2. http2.0对比1.X版本主要区别就是多路复用